# Как запустить
1. Если ingress не установлен, то установить выполнив из папки infra

        ./install_ingress.sh

1. Установить приложение командой (устанавливается в default namespace)

        helm install hw22 ./chart
        
    или
    
        helm repo add confluentinc https://confluentinc.github.io/cp-helm-charts/
        helm repo add bitnami https://charts.bitnami.com/bitnami
        skaffold run

1. Запустить тесты

        for i in {1..10}; do newman run otus-hw22.postman_collection.json; done

    по-умолчанию запросы идут на arch.homework/otus.
    для изменения можно использовать опцию: 

        --env-var "baseUrl=another.url/app"

# Описание
Реализован шардинг в сервисе order-service. Этот сервис выбран так как для него предполагается большое количество операций записи, а также типовые операции чтения заказов предполагают чтение по id.

Шардирование сделано по id заказа, которое является uuid и генерируется приложением перед записью в БД.

При работе с БД заказов первым делом вычисляется hash код id заказа, далее берется остаток от деления хэш-кода на количество шардов(2).

Таким образом равномерное распределение обеспечивается качествами хэш-функции.

При дальнейшем масштабировании возможно увеличение количества шардов вдвое - данные каждого шарда можно разделить на две части примерно равного размера

Тест в постман производит создание заказа и его чтение. Тест выполняется несколько раз - так заказы попадают в оба шарда.
